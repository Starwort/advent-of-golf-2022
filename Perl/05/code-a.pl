/m/?do{($A,$B,$t)=/\d+/g;$g[$B]=~s/^.{$A}//;$g[$t]=$&.$g[$t];$f[$B]=~s/^.{$A}//;$f[$t]=reverse($&).$f[$t]}:s!\w!$g[$z]=$f[$z=$`=~y///c/4+1].=$&!ge for<>;print/^./g,for@f,$",@g